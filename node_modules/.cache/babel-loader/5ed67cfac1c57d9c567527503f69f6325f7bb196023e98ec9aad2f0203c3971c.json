{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import'./editProfile.css';import axios from'axios';import{AuthContext}from'../../context/AuthContext';import{Storage}from'@capacitor/storage';import{useHistory}from'react-router-dom/cjs/react-router-dom.min';import Button from'@mui/material/Button';import Dialog from'@mui/material/Dialog';import DialogActions from'@mui/material/DialogActions';import DialogContent from'@mui/material/DialogContent';import DialogContentText from'@mui/material/DialogContentText';import DialogTitle from'@mui/material/DialogTitle';import{CircularProgress}from'@mui/material';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function EditProfile(){const[password,setPassword]=useState('');const[images,setImages]=useState([]);const[name,setName]=useState('');const[avatar,setAvatr]=useState([]);const[dalog,setDalog]=useState(false);const[loading,setLoading]=useState(false);const history=useHistory();const{jwt,setPostId}=useContext(AuthContext);useEffect(()=>{getData();},[jwt]);const updatePro=async()=>{const data={name,password};try{setDalog(true);setLoading(true);await axios.put('http://localhost:4000/account/update',data,{headers:{Authorization:jwt}});Storage.remove({key:\"accessToken\"});history.push('/get-all-post');setLoading(false);}catch(e){console.log(e);setLoading(false);}};const handelClose=()=>{setDalog(false);};const getData=async()=>{try{const getUserPost=await axios.get('http://localhost:4000/get-my-post',{headers:{Authorization:jwt}}).then(res=>{const getPost=res.data.data.map(item=>item.img);setImages(getPost);});if(getUserPost==undefined){const getUserData=await axios.get('http://localhost:4000/getUserId',{headers:{Authorization:jwt}});console.log(getUserData);setName(getUserData.data.name);setAvatr(getUserData.data.avatar);}}catch(e){console.log(e);}};const handleClick=async index=>{const response=await axios.get('http://localhost:4000/get-all-post');setPostId(response.data.data[index]._id);history.push('/post/get-post');};return/*#__PURE__*/_jsx(_Fragment,{children:loading?/*#__PURE__*/_jsx(CircularProgress,{size:70,sx:{position:\"fixed\",left:\"50%\",top:\"50%\",transform:\"translate(-50%, -50%)\",zIndex:2}}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Dialog,{open:dalog,keepMounted:true,\"aria-describedby\":\"alert-dialog-slide-description\",children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"انت على وشك تعديل بياناتك\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(DialogContentText,{id:\"alert-dialog-slide-description\",children:\"\\u0647\\u0644 \\u062A\\u0648\\u062F \\u0627\\u0644\\u0645\\u062A\\u0627\\u0628\\u0639\\u0647\\u061F\"})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handelClose,children:\"\\u0644\\u0627\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>history.push('/login'),children:\"\\u0645\\u0648\\u0627\\u0641\\u0642\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-profile\",children:[/*#__PURE__*/_jsx(Button,{style:{position:'absolute',right:'1%',top:'3%',fontSize:\"40px\"},onClick:()=>history.push(\"/timesheet\"),children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-arrow-circle-o-right\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form\",children:[/*#__PURE__*/_jsx(\"img\",{src:avatar,className:\"edit-img\",alt:\"error\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-form\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:name,value:name,onChange:e=>setName(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Edit Password (Required)\",type:\"password\",value:password,onChange:e=>setPassword(e.target.value)})]}),/*#__PURE__*/_jsx(\"button\",{onClick:updatePro,className:\"sub-button\",type:\"sumet\",children:\"Edit\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"img-continner\",children:/*#__PURE__*/_jsx(\"div\",{className:\"img-form\",children:images.map((img,index)=>/*#__PURE__*/_jsx(\"img\",{onClick:()=>handleClick(index),src:img},index)).reverse()})})]})});}export default EditProfile;","map":{"version":3,"names":["React","useContext","useEffect","useState","axios","AuthContext","Storage","useHistory","Button","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","CircularProgress","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","EditProfile","password","setPassword","images","setImages","name","setName","avatar","setAvatr","dalog","setDalog","loading","setLoading","history","jwt","setPostId","getData","updatePro","data","put","headers","Authorization","remove","key","push","e","console","log","handelClose","getUserPost","get","then","res","getPost","map","item","img","undefined","getUserData","handleClick","index","response","_id","children","size","sx","position","left","top","transform","zIndex","open","keepMounted","id","onClick","className","style","right","fontSize","src","alt","placeholder","value","onChange","target","type","reverse"],"sources":["C:/Users/baaan/Desktop/Photogram/photogramclient/src/pages/editProfile/EditProfile.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport './editProfile.css';\r\nimport axios from 'axios'\r\nimport { AuthContext } from '../../context/AuthContext';\r\nimport { Storage } from '@capacitor/storage';\r\nimport { useHistory } from 'react-router-dom/cjs/react-router-dom.min';\r\nimport Button from '@mui/material/Button';\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogActions from '@mui/material/DialogActions';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport DialogContentText from '@mui/material/DialogContentText';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\nimport { CircularProgress } from '@mui/material';\r\n\r\nfunction EditProfile() {\r\n\r\n    const [password, setPassword] = useState('');\r\n    const [images, setImages] = useState([]);\r\n    const [name, setName] = useState('');\r\n    const [avatar, setAvatr] = useState([]);\r\n    const [dalog, setDalog] = useState(false);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const history = useHistory()\r\n    const { jwt, setPostId } = useContext(AuthContext);\r\n\r\n\r\n    useEffect(() => {\r\n        getData()\r\n    }, [jwt]);\r\n\r\n\r\n    const updatePro = async () => {\r\n        const data = {\r\n            name,\r\n            password,\r\n        }\r\n        try {\r\n            setDalog(true)\r\n            setLoading(true)\r\n            await axios.put('http://localhost:4000/account/update', data, {\r\n                headers: {\r\n                    Authorization: jwt\r\n                }\r\n            })\r\n            Storage.remove({\r\n                key: \"accessToken\"\r\n            })\r\n            history.push('/get-all-post')\r\n            setLoading(false)\r\n        } catch (e) {\r\n            console.log(e)\r\n            setLoading(false)\r\n        }\r\n    };\r\n\r\n    const handelClose = () => {\r\n        setDalog(false)\r\n    };\r\n\r\n    const getData = async () => {\r\n        try {\r\n           const getUserPost = await axios.get('http://localhost:4000/get-my-post',\r\n                {\r\n                    headers: {\r\n                        Authorization: jwt\r\n                    }\r\n                }).then(res=>     \r\n                {   \r\n                    const getPost = res.data.data.map(item => item.img);\r\n                    setImages(getPost);\r\n                })\r\n        if (getUserPost == undefined){\r\n                    const getUserData = await axios.get('http://localhost:4000/getUserId',\r\n                {\r\n                    headers: {\r\n                        Authorization: jwt\r\n                    }\r\n                })     \r\n                   console.log(getUserData)\r\n                   setName(getUserData.data.name);\r\n                   setAvatr(getUserData.data.avatar);\r\n        }\r\n\r\n        } catch(e) {\r\n            console.log(e)\r\n        }\r\n    }\r\n\r\n    const handleClick = async (index) => {\r\n        const response = await axios.get('http://localhost:4000/get-all-post')\r\n        setPostId(response.data.data[index]._id)\r\n        history.push('/post/get-post')\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {\r\n                loading ? <CircularProgress size={70}\r\n                    sx={{\r\n                        position: \"fixed\",\r\n                        left: \"50%\",\r\n                        top: \"50%\",\r\n                        transform: \"translate(-50%, -50%)\",\r\n                        zIndex: 2\r\n                    }} />\r\n                    :\r\n                    <>\r\n                        <Dialog\r\n                            open={dalog}\r\n                            keepMounted\r\n                           \r\n                            aria-describedby=\"alert-dialog-slide-description\"\r\n                        >\r\n                            <DialogTitle>{\"انت على وشك تعديل بياناتك\"}</DialogTitle>\r\n                            <DialogContent>\r\n                                <DialogContentText id=\"alert-dialog-slide-description\">\r\n                                    هل تود المتابعه؟\r\n                                </DialogContentText>\r\n                            </DialogContent>\r\n                            <DialogActions>\r\n                                <Button onClick={handelClose}>لا</Button>\r\n                                <Button onClick={() => history.push('/login')}>موافق</Button>\r\n                            </DialogActions>\r\n                        </Dialog>\r\n                        <div className='edit-profile'>\r\n                        <Button style={{position: 'absolute', right: '1%', top: '3%', fontSize: \"40px\"}} onClick={() => history.push(\"/timesheet\")}\r\n                    ><i className=\"fa fa-arrow-circle-o-right\"></i></Button>\r\n                            <div className='form'>\r\n                                <img src={avatar} className='edit-img' alt='error' />\r\n                                <div className='edit-form'>\r\n                                    <input placeholder={name} value={name} onChange={(e) => setName(e.target.value)} />\r\n                                    <input placeholder='Edit Password (Required)' type='password' value={password} onChange={(e) => setPassword(e.target.value)} />\r\n                                </div>\r\n                                <button onClick={updatePro} className='sub-button' type='sumet'>Edit</button>\r\n                            </div>\r\n                        </div>\r\n                        <div className='img-continner'>\r\n                            <div className='img-form'>\r\n                                {\r\n                                    images.map((img, index) => (\r\n                                        <img onClick={() => handleClick(index)} src={img} key={index} />\r\n                                    )).reverse()\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                    </>\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default EditProfile"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}